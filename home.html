<html lang="en">
  <head>
      <meta charset="utf-8"/>
      <meta content="width=device-width, initial-scale=1" name="viewport"/>
      <title>
       Twilight foliage
      </title>
      <script src="https://cdn.tailwindcss.com">
      </script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
      <link rel="stylesheet" href="style.css" type="text/css" media="all" />
    <link rel="icon" href="./img/favicon.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bilbo+Swash+Caps&family=Merienda:wght@300..900&family=Oooh+Baby&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
 </head>
 <body>
   <!-- hero -->
  <section id="hero" class="relative w-full min-h-screen text-white overflow-hidden">

  <!-- Background slideshow -->
  <div class="absolute inset-0 z-0 pointer-events-none">
    <div id="bgA" class="absolute inset-0 bg-cover bg-center opacity-100 transition-opacity duration-1000"></div>
    <div id="bgB" class="absolute inset-0 bg-cover bg-center opacity-0 transition-opacity duration-1000"></div>
  </div>
  
  <!-- Partikel -->
  <div id="particles" class="absolute inset-0 z-10 overflow-hidden"></div>

  <!-- Overlay -->
  <div class="absolute inset-0 z-20 bg-[#201e1f]/60"></div>
  <div class="absolute inset-0 z-30 bg-gradient-to-b from-transparent via-[#201e1f]/40 to-[#201e1f]"></div>

  <!-- FRAME + ISIANNYA -->
  <div class="relative z-40 flex items-center justify-center">
    <div class="relative w-[380px]">
      <!-- Frame PNG -->
      <img src="./img/fr.png" alt="Frame" class="w-full h-auto relative">

      <!-- Isi frame -->
      <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-6 py-8 z-20">
        <!-- Ikon Ornamen -->
        <img src="./img/or2.png" alt="ornamen" class="w-32 h-auto mb-4 reveal zoom-in opacity-0 scale-95 transition-all duration-1000">

        <!-- The Wedding Of -->
        <p class="text-sm tracking-wide mb-2 font-jakarta text-krem reveal zoom-in opacity-0 scale-95 transition-all duration-1000">The Wedding Of</p>

        <!-- Nama Pasangan -->
        <h3 class="text-7xl font-bilbo mb-2 text-krem reveal zoom-in opacity-0 scale-95 transition-all duration-1000">Bro &amp; Sis</h3>

        <!-- Tanggal -->
        <p class="text-xs mb-4 font-jakarta text-krem reveal zoom-in opacity-0 scale-95 transition-all duration-1000">Kamis, 11 Oktober 2028</p>

        <!-- Countdown -->
        <div id="countdown" class="flex gap-3 mb-6 text-sm font-semibold reveal zoom-in opacity-0 scale-95 transition-all duration-1000">
          <div class="flex flex-col items-center">
            <span id="days" class="text-xl text-krem font-merienda">00</span>
            <span class="font-jakarta text-krem">Hari</span>
          </div>
          <div class="flex flex-col items-center">
            <span id="hours" class="text-xl text-krem font-merienda">00</span>
            <span class="text-krem font-jakarta">Jam</span>
          </div>
          <div class="flex flex-col items-center">
            <span id="minutes" class="text-xl text-krem font-merienda">00</span>
            <span class="text-krem font-jakarta">Menit</span>
          </div>
          <div class="flex flex-col items-center">
            <span id="seconds" class="text-xl text-krem font-merienda">00</span>
            <span class="font-jakarta text-krem">Detik</span>
          </div>
        </div>

        <!-- Button Save The Date -->
            <a href="gcaleneder">
    <button class="px-4 py-2 border-2 border-[#d5a776] text-krem rounded-full bg-transparent reveal slide-up opacity-0 translate-y-10 transition-all duration-1000">
  Save The Date
</button>

    </a>
      </div>
    </div>
  </div>
</section>

  <div id="mempelai"></div>
  <div id="qoutes"></div>
  <div id="acara"></div>
  <div id="story"></div>
  <div id="gallery"></div>
  
  <!-- rsvp -->
<section id="rsvp" class="bg-ireng py-9">
  
  <div class="text-center mt-3 mb-9">
       <h3 class="text-center text-abang text-3xl font-merienda">BERIKAN</h3>
       <p class="text-center text-krem text-4xl font-baby -mt-5">
         Ucapan
       </p>
     </div>
        <div class="grid grid-cols-3 gap-4 text-center mt-4 mb-8 mx-4 reveal slide-down opacity-0 -translate-y-10 transition-all duration-1000 ease-out">
      <div class="bg-abang border-2 border-krem p-4 rounded-lg shadow">
        <h3 class="text-5xl font-merienda text-krem" id="countHadir">0</h3>
        <p class="font-jakarta text-krem text-sm">Hadir</p>
      </div>
      <div class="bg-abang border-2 border-krem p-4 rounded-lg shadow">
        <h3 class="text-5xl font-merienda text-krem" id="countTidak">0</h3>
        <p class="font-jakarta text-krem text-sm">Tidak Hadir</p>
      </div>
      <div class="bg-abang border-krem border-2 p-4 rounded-lg shadow">
        <h3 class="text-5xl font-merienda text-krem" id="countRagu">0</h3>
        <p class="text-krem font-jakarta text-sm">Ragu</p>
      </div>
    </div>
        
           <!-- Form RSVP -->
   <div class="bg-abang border-2 border-krem p-6 rounded-2xl shadow-lg mb-8 mx-4 reveal zoom-in opacity-0 scale-95 transition-all duration-1000 ease-out">
  <form id="rsvpForm" class="space-y-4">
    <input type="text" id="nama" placeholder="Nama" required
      class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#d5a776] font-jakarta text-ireng placeholder-gray-500">

    <select id="status" required
      class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#d5a776] font-jakarta text-ireng">
      <option value="" disabled selected>Konfirmasi Kehadiran</option>
      <option value="Hadir">Hadir</option>
      <option value="Tidak Hadir">Tidak Hadir</option>
      <option value="Ragu">Ragu</option>
    </select>

    <textarea id="ucapan" placeholder="Tulis ucapan..." rows="3"
      class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#d5a776] font-jakarta text-ireng placeholder-gray-500"></textarea>

    <button type="submit"
      class="w-full bg-krem text-abang py-2 rounded-lg font-dosis">
      Kirim
    </button>
  </form>
</div>


    <!-- List Ucapan -->
    <!-- List Ucapan -->
<div class="bg-abang border-2 border-krem p-6 rounded-2xl shadow-lg mx-4 reveal slide-up opacity-0 translate-y-10 transition-all duration-1000 ease-out">
  <h3 class="text-xl font-merienda mb-4 text-krem text-center">Ucapan &amp; Doa</h3>
  <div id="listUcapan" class="space-y-4"></div>

  <!-- Pagination -->
  <div class="flex justify-between mt-4">
    <button id="prevBtn" class="bg-krem text-abang px-4 py-2 rounded-lg font-jakarta disabled:opacity-50">Prev</button>
    <button id="nextBtn" class="bg-krem text-abang px-4 py-2 rounded-lg font-jakarta disabled:opacity-50">Next</button>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="hidden fixed bottom-20 right-5 left-5 bg-krem text-semi px-4 py-2 rounded-lg shadow-lg text-center font-jakarta">
  terkirim
</div>
    </section>
    
    <div id="amplop"></div>
    <div id="closing"></div>
    <div id="footer"></div>
    <div id="navbar"></div>
    
    <!-- Tombol Musik -->
<audio id="bg-music" autoplay loop>
  <source src="./musik/bgm.mp3" type="audio/mpeg" />
</audio>

<button id="btn-music" class="scroll-btn reveal zoom-in opacity-0 scale-95 transition-all duration-1000">
  <i id="icon-music" class="fa-solid fa-pause"></i>
</button>

<!-- Tombol Scroll -->
<button id="btn-scroll" class="scroll-btn reveal zoom-in opacity-0 scale-95 transition-all duration-1000">
  <i id="icon-scroll" class="fa-solid fa-arrow-down"></i>
</button>


<!-- script musik dan autiscroll -->
  <script>
    const music = document.getElementById("bg-music");
    const btnMusic = document.getElementById("btn-music");
    const iconMusic = document.getElementById("icon-music");

    const btnScroll = document.getElementById("btn-scroll");
    const iconScroll = document.getElementById("icon-scroll");

    let scrollInterval;

    function startScroll() {
      if (!scrollInterval) {
        scrollInterval = setInterval(() => {
          window.scrollBy(0, 1);
        }, 30);
        iconScroll.className = "fa-solid fa-arrow-down";
      }
    }

    function stopScroll() {
      clearInterval(scrollInterval);
      scrollInterval = null;
      iconScroll.className = "fa-solid fa-computer-mouse";
    }

    // kontrol musik
    btnMusic.addEventListener("click", () => {
      if (music.paused) {
        music.play();
        iconMusic.className = "fa-solid fa-pause";
      } else {
        music.pause();
        iconMusic.className = "fa-solid fa-play";
      }
    });

    // kontrol scroll
    btnScroll.addEventListener("click", () => {
      if (scrollInterval) stopScroll();
      else startScroll();
    });

    // autoplay setelah klik index
    window.addEventListener("load", () => {
  if (localStorage.getItem("autoplay") === "true") {
    music.play().catch(err => console.log("Autoplay blocked:", err));
    startScroll();
    localStorage.removeItem("autoplay");
  }
});

  </script>
  
<!-- script rsvp -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    query,
    orderBy,
    limit,
    startAfter,
    startAt,
    getDocs,
    getCountFromServer,
    where,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

  // Firebase Config (sama seperti punya lo)
  const firebaseConfig = {
    apiKey: "AIzaSyCEoYY7gMXbFsWk1LTLV8tWgRh-EmppLRQ",
    authDomain: "undangan-premium-2.firebaseapp.com",
    projectId: "undangan-premium-2",
    storageBucket: "undangan-premium-2.firebasestorage.app",
    messagingSenderId: "866479227286",
    appId: "1:866479227286:web:8c04af13cb1b21d3dd9db7",
    measurementId: "G-H70RRW8ZL7"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Collection RSVP
  const rsvpCollection = collection(db, "rsvp_data");

  const form = document.getElementById("rsvpForm");
  const listUcapan = document.getElementById("listUcapan");
  const toast = document.getElementById("toast");

  const countHadir = document.getElementById("countHadir");
  const countTidak = document.getElementById("countTidak");
  const countRagu = document.getElementById("countRagu");

  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");

  let firstVisible = null;   // doc snapshot of first item in current page
  let lastVisible = null;    // doc snapshot of last item in current page
  let currentPageDocs = [];
  let pageStack = [];        // store `firstVisible` snapshot for each page in order
  const pageSize = 5;
  let isLoading = false;

  // submit rsvp
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const nama = document.getElementById("nama").value.trim();
    const status = document.getElementById("status").value;
    const ucapan = document.getElementById("ucapan").value.trim();

    if (!nama || !status) return;

    try {
      await addDoc(rsvpCollection, {
        nama,
        status,
        ucapan,
        createdAt: serverTimestamp()
      });

      form.reset();

      // toast
      toast.classList.remove("hidden");
      setTimeout(() => toast.classList.add("hidden"), 3000);

      // refresh ke page pertama (biasanya pengharapan user)
      await loadData(); 
      await loadCounts();
    } catch (err) {
      console.error("Error addDoc:", err);
    }
  });

  // load counts per status
  async function loadCounts() {
    try {
      const qHadir = query(rsvpCollection, where("status", "==", "Hadir"));
      const qTidak = query(rsvpCollection, where("status", "==", "Tidak Hadir"));
      const qRagu  = query(rsvpCollection, where("status", "==", "Ragu"));

      const [hadirSnap, tidakSnap, raguSnap] = await Promise.all([
        getCountFromServer(qHadir),
        getCountFromServer(qTidak),
        getCountFromServer(qRagu)
      ]);

      countHadir.textContent = hadirSnap.data().count ?? 0;
      countTidak.textContent = tidakSnap.data().count ?? 0;
      countRagu.textContent = raguSnap.data().count ?? 0;
    } catch (err) {
      console.error("Error loadCounts:", err);

      // fallback
      try {
        const [hadirDocs, tidakDocs, raguDocs] = await Promise.all([
          getDocs(query(rsvpCollection, where("status", "==", "Hadir"))),
          getDocs(query(rsvpCollection, where("status", "==", "Tidak Hadir"))),
          getDocs(query(rsvpCollection, where("status", "==", "Ragu")))
        ]);
        countHadir.textContent = hadirDocs.size;
        countTidak.textContent = tidakDocs.size;
        countRagu.textContent = raguDocs.size;
      } catch (e) {
        console.error("Fallback count failed:", e);
      }
    }
  }

  // helper disable tombol saat loading
  function setLoadingState(state) {
    isLoading = state;
    prevBtn.disabled = state || (pageStack.length <= 1);
    nextBtn.disabled = state; // we'll set correct state after load
  }

  // load data with pagination
  // call: loadData() => first page
  //       loadData({ next: true }) => next page
  //       loadData({ prev: true }) => previous page
  async function loadData(opts = {}) {
    const { next = false, prev = false } = opts;

    if (isLoading) return;
    setLoadingState(true);

    try {
      let q;

      if (next && lastVisible) {
        // next page: after lastVisible
        q = query(rsvpCollection, orderBy("createdAt", "desc"), startAfter(lastVisible), limit(pageSize));
      } else if (prev) {
        // prev page:
        if (pageStack.length <= 1) {
          // sudah di first page -> load first page
          q = query(rsvpCollection, orderBy("createdAt", "desc"), limit(pageSize));
        } else {
          // buang entry halaman sekarang dari stack (current page first)
          pageStack.pop();
          const prevFirst = pageStack[pageStack.length - 1]; // firstVisible snapshot of target page
          if (prevFirst) {
            // gunakan startAt(prevFirst) untuk mendapatkan halaman yang dimaksud
            q = query(rsvpCollection, orderBy("createdAt", "desc"), startAt(prevFirst), limit(pageSize));
          } else {
            q = query(rsvpCollection, orderBy("createdAt", "desc"), limit(pageSize));
          }
        }
      } else {
        // initial load / direct load first page
        q = query(rsvpCollection, orderBy("createdAt", "desc"), limit(pageSize));
        pageStack = [];
      }

      const snap = await getDocs(q);

      if (!snap.empty) {
        currentPageDocs = snap.docs;
        firstVisible = snap.docs[0];
        lastVisible = snap.docs[snap.docs.length - 1];

        // jika ini bukan aksi 'prev', push firstVisible ke stack
        if (!prev) {
          const top = pageStack[pageStack.length - 1];
          if (!top || top.id !== firstVisible.id) {
            pageStack.push(firstVisible);
          }
        }
        renderList(snap.docs);
      } else {
        listUcapan.innerHTML = "<p class='text-krem text-sm'>Belum ada ucapan</p>";
        // reset pagination state
        pageStack = [];
        firstVisible = null;
        lastVisible = null;
      }

      // set tombol prev/next
      prevBtn.disabled = pageStack.length <= 1;
      nextBtn.disabled = snap.size < pageSize;
    } catch (err) {
      console.error("Error loadData:", err);
    } finally {
      setLoadingState(false);
    }
  }

  // render list
  function renderList(docs) {
    listUcapan.innerHTML = "";
    docs.forEach((doc) => {
      const data = doc.data();
      const div = document.createElement("div");
      div.className = "p-4 border border-krem rounded-lg text-krem";
      div.innerHTML = `
        <p class="font-bold">${escapeHtml(data.nama || "")} - 
        <span class="italic">${escapeHtml(data.status || "")}</span></p>
        <p class="text-sm">${escapeHtml(data.ucapan || "")}</p>
      `;
      listUcapan.appendChild(div);
    });
  }

  function escapeHtml(str) {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  // events
  nextBtn.addEventListener("click", () => loadData({ next: true }));
  prevBtn.addEventListener("click", () => loadData({ prev: true }));

  // init
  loadData();
  loadCounts();
</script>

<!-- script navbar -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      // delay dikit biar smooth jalan setelah load
      setTimeout(() => {
        target.scrollIntoView({
          behavior: "smooth",
          block: "start"
        });
      }, 300);
    }
  }
});
</script>

<!-- script slideshow -->
<script>
    //ganti bg
  const images = [
    "./img/ft1.jpg",
    "./img/ft2.jpg",
    "./img/ft3.jpg",
    "./img/ft4.jpg",
    "./img/ft5.jpg"
  ];

  // preload biar nggak kedip putih saat ganti
  images.forEach(src => { const i = new Image(); i.src = src; });

  const bgA = document.getElementById("bgA");
  const bgB = document.getElementById("bgB");

  let showingA = true;   // layer mana yang sedang kelihatan
  let index = 1;         // next image index (kita tampilkan ft1 dulu di A)

  // set foto awal
  bgA.style.backgroundImage = `url('${images[0]}')`;
  bgB.style.backgroundImage = `url('${images[1 % images.length]}')`;

  function crossfade() {
    const nextUrl = images[index % images.length];
    const fadeIn = showingA ? bgB : bgA;
    const fadeOut = showingA ? bgA : bgB;

    // siapkan gambar berikutnya di layer yang akan fade-in
    fadeIn.style.backgroundImage = `url('${nextUrl}')`;

    // lakukan crossfade
    fadeOut.classList.remove("opacity-100");
    fadeOut.classList.add("opacity-0");
    fadeIn.classList.remove("opacity-0");
    fadeIn.classList.add("opacity-100");

    // toggle state
    showingA = !showingA;
    index++;
  }

  // mulai slideshow
  setInterval(crossfade, 4000); // ganti tiap 5 detik
</script>

<!-- script countdown -->
<script>
  // Set target tanggal
  const targetDate = new Date("Oct 11, 2028 08:00:00").getTime();

  function updateCountdown() {
    const now = new Date().getTime();
    const distance = targetDate - now;

    if (distance < 0) {
      // Kalau sudah lewat tanggal
      document.getElementById("countdown").innerHTML = "<p class='text-lg font-semibold'>The Wedding Has Started ðŸŽ‰</p>";
      return;
    }

    // Hitung waktu
    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    // Update ke elemen HTML
    document.getElementById("days").innerText = days;
    document.getElementById("hours").innerText = hours;
    document.getElementById("minutes").innerText = minutes;
    document.getElementById("seconds").innerText = seconds;
  }

  // Panggil pertama kali
  updateCountdown();

  // Update tiap 1 detik
  setInterval(updateCountdown, 1000);
</script>

<!-- animasi -->
<script>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const el = entry.target;

        if (el.classList.contains("slide-left")) {
          el.classList.remove("opacity-0", "-translate-x-10");
          el.classList.add("opacity-100", "translate-x-0");
        }

        if (el.classList.contains("slide-right")) {
          el.classList.remove("opacity-0", "translate-x-10");
          el.classList.add("opacity-100", "translate-x-0");
        }

        if (el.classList.contains("slide-down")) {
          el.classList.remove("opacity-0", "-translate-y-10");
          el.classList.add("opacity-100", "translate-y-0");
        }

        if (el.classList.contains("slide-up")) {
          el.classList.remove("opacity-0", "translate-y-10");
          el.classList.add("opacity-100", "translate-y-0");
        }

        if (el.classList.contains("fade-in")) {
          el.classList.remove("opacity-0");
          el.classList.add("opacity-100");
        }

        if (el.classList.contains("zoom-in")) {
          el.classList.remove("opacity-0", "scale-95");
          el.classList.add("opacity-100", "scale-100");
        }

        observer.unobserve(el); // Stop observe biar ga diulang
      }
    });
  });

  document.querySelectorAll(".reveal").forEach((el) => observer.observe(el));
</script>

<!-- gallery sweeper ples loadsection -->
<script>
  // Swiper init
  function initGallerySwiper() {
    const swiper = new Swiper(".mySwiper", {
      loop: true,
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      }
    });
  }

  // Load Section + Animasi + Gallery
  function loadSection(id, url) {
    fetch(url)
      .then((response) => {
        if (!response.ok) throw new Error("Gagal load " + url);
        return response.text();
      })
      .then((data) => {
        const container = document.getElementById(id);
        container.innerHTML = data;

        // ðŸ”¹ Re-init observer animasi
        container.querySelectorAll(".reveal").forEach((el) => {
          observer.observe(el);
        });

        // ðŸ”¹ Khusus gallery â†’ init swiper
        if (id === "gallery") {
          initGallerySwiper();
        }
      })
      .catch((error) => console.error("Error:", error));
  }

  // ðŸ”¹ Call semua section
  loadSection("mempelai", "./mempelai.html");
  loadSection("acara", "./acara.html");
  loadSection("story", "./story.html");
  loadSection("gallery", "./gallery.html");
  loadSection("qoutes", "./qoutes.html");
  loadSection("closing", "./closing.html");
  loadSection("footer", "./footer.html");
  loadSection("amplop", "./amplop.html");
  loadSection("navbar", "./navbar.html");
</script>

<!-- sctipt copy -->
<script>
  document.addEventListener("click", (e) => {
  if (e.target.classList.contains("copy-btn")) {
    const norek = e.target.getAttribute("data-norek");
    navigator.clipboard.writeText(norek).then(() => {
      const toast = document.getElementById("toast");
      toast.classList.remove("opacity-0");
      toast.classList.add("opacity-100");

      setTimeout(() => {
        toast.classList.remove("opacity-100");
        toast.classList.add("opacity-0");
      }, 2500);
    });
  }
});
</script>

 </body>
 </html>